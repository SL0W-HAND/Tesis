\chapter{Formalismo de Hamilton en relatividad general}
\label{chap:hamilton}
El formalismo de Hamilton es una reformulación de la mecánica clásica que se utiliza para describir sistemas dinámicos. En relatividad general, este formalismo se adapta para manejar la dinámica del espacio-tiempo y los campos gravitacionales.
Clásicamente la acción se define como la integral del lagrangiano $L$ a lo largo del tiempo
\[
    S = \int L dt
\]
y el lagrangiano es una función de las coordenadas generalizadas $q_i$ y sus velocidades $\dot{q}_i$ (derivadas respecto al tiempo)
\[
    L = L(q_i, \dot{q}_i, t)
\]

tomemos la acción de una partícula libre de masa $M$ en un espacio-tiempo curvo respecto a su tiempo propio $\tau$
\begin{equation}
    S = \int -Mc^2 \mathbf{d}\tau  \qquad [\text{Energía} \cdot  \text{Tiempo}].
\end{equation}
Por definición del tiempo propio $d\tau^2 = -ds^2/c^2$
\begin{equation}
    S = \int -Mc \sqrt{-g_{\mu \nu} \frac{dx^\mu}{d\lambda} \frac{dx^\nu}{d\lambda}} d\lambda
    \label{eq:accionParticulaRaiz}
\end{equation}
bajo la parametrización arbitraria $\lambda$ (que puede ser el tiempo coordenado $t$, el tiempo propio $\tau$ o cualquier otro parámetro afín).
Por razones de sencillez y para tener congruencia con los textos que están ahi afuera como \cite[p. 45]{wald-1984} que presentan un lagrangiano sin la raíz cuadrada, se tomara el parámetro afín $\lambda = \tau$ tal que la normalización
\begin{equation}
    g_{\mu \nu} \frac{dx^\mu}{d\tau} \frac{dx^\nu}{d\tau} = -c^2 \rightarrow \sqrt{-g_{\mu \nu} \frac{dx^\mu}{d\tau} \frac{dx^\nu}{d\tau}} = c.
\end{equation}
Además de eso por mera conveniencia matemática se multiplicara por el factor un medio, de esta forma la acción queda
\begin{equation}
    S  =  \int \frac{M}{2}  g_{\mu \nu} \frac{dx^\mu}{d\tau} \frac{dx^\nu}{d\tau} d\tau.
\end{equation}
Esta acción es equivalente a la de (\ref{eq:accionParticulaRaiz}) ya que ambas producen las mismas ecuaciones de movimiento (geodésicas) y difieren en una constante multiplicativa(que no afecta las ecuaciones de movimiento).
El lagrangiano es entonces
\begin{equation}
    L = \frac{1}{2} M g_{\mu \nu} \dot{x}^\mu \dot{x}^\nu
\end{equation}
donde $\dot{x}^\mu = dx^\mu / d\tau$
\begin{note}
    En esta parte intente hacer el enfoque mas natural para proponer el lagrangiano de la acción, ahi afuera hay varias formas de llegar a este lagrangiano, a veces solo se propone el lagrangiano sin la raíz cuadrada sin justificar mucho de donde ha salido.

    Fragmento tomado de \cite[ver p. 45]{wald-1984}:
    \begin{quote}
        An identical derivation shows that the curves which extremize proper time between two points are precisely the timelike geodesics. These derivations also show that the geodesic equation (with affine parameterization) can be obtained from variation of the Lagrangian,
        $$
            L=\sum_{\mu, \nu} g_{\mu \nu} \frac{d x^\mu}{d t} \frac{d x^\nu}{d t}
        $$
    \end{quote}
\end{note}

Ya que este lagrangiano describe la dinámica de una particula libre en un espacio-tiempo curvo, este mismo debe de ser compatible con la ecuación de geodésicas \ref{eq:geodesic}, es decir, las ecuaciones de movimiento que se obtienen al aplicar el principio de mínima acción i.e. las ecuaciones de Euler-Lagrange a este lagrangiano deben ser las ecuaciones de geodésicas.
\begin{equation}
    \frac{d}{d\tau} \left( \frac{\partial L}{\partial \dot{x}^\beta} \right) - \frac{\partial L}{\partial x^\beta} = 0
\end{equation}

Para el lagrangiano propuesto, las ecuaciones de Euler-Lagrange se convierten en
\begin{equation}
    \begin{aligned}
        \frac{d}{d\tau} \left( \frac{\partial }{\partial \dot{x}^\beta} \left(\frac{1}{2} M g_{\mu \nu} \dot{x}^\mu \dot{x}^\nu \right) \right) - \frac{\partial }{\partial x^\beta}\left(\frac{1}{2} M g_{\mu \nu} \dot{x}^\mu \dot{x}^\nu \right) = 0 \\
        \frac{d}{d\tau} \left( \frac{1}{2} M g_{\mu \nu} \frac{\partial }{\partial \dot{x}^\beta} \left(  \dot{x}^\mu \dot{x}^\nu \right) \right)
        - \frac{1}{2} M \left( \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0                                                                                                                                                           \\
        \frac{d}{d\tau} \left( \frac{1}{2}  g_{\mu \nu}  \left(  \dot{x}^\mu \delta_\beta^\nu +\delta_\beta^\mu \dot{x}^\nu \right) \right)
        - \frac{1}{2}  \left( \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0                                                                                                                                                            \\
        \frac{d}{d\tau} \left( \frac{1}{2}   \left(  g_{\mu \beta} \dot{x}^\mu  + g_{\beta \nu}  \dot{x}^\nu \right) \right)
        - \frac{1}{2}  \left( \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0                                                                                                                                                            \\
        \frac{d}{d\tau} \left(    g_{\mu \beta} \dot{x}^\mu \right)
        - \frac{1}{2}  \left( \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0                                                                                                                                                            \\
        \left(\partial_\sigma g_{\mu \beta }\right) \dot{x}^\sigma \dot{x}^\mu+    g_{\mu \beta} \frac{d \dot{x}^\mu}{d\tau}
        - \frac{1}{2}  \left( \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0                                                                                                                                                            \\
        \frac{1}{2}\left(\partial_\sigma g_{\mu \beta } + \partial_\mu g_{\sigma \beta } \right) \dot{x}^\sigma \dot{x}^\mu+    g_{\mu \beta} \frac{d \dot{x}^\mu}{d\tau}
        - \frac{1}{2}  \left( \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0                                                                                                                                                            \\
        g_{\mu \beta}  \ddot{x}^\mu+
        \frac{1}{2}\left(\partial_\nu g_{\mu \beta } + \partial_\mu g_{\nu \beta } -  \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0                                                                                                    \\
        g^{\alpha \beta}g_{\mu \beta}  \ddot{x}^\mu+
        \underbrace{g^{\alpha \beta}\frac{1}{2}\left(\partial_\nu g_{\mu \beta } + \partial_\mu g_{\nu \beta } -  \partial_\beta g_{\mu \nu} \right) \dot{x}^\mu \dot{x}^\nu = 0}_{\Gamma^\alpha_{\mu \nu}}                                             \\
        \ddot{x}^\alpha + \Gamma^\alpha_{\mu \nu} \dot{x}^\mu \dot{x}^\nu = 0
    \end{aligned}
\end{equation}

que son precisamente las ecuaciones de geodésicas (\ref{eq:geodesic}).

\section{Ecuación de Hamilton-Jacobi para geodésicas}
Una vez que hemos comprobado que el lagrangiano propuesto describe la dinámica de una partícula libre en un espacio-tiempo curvo, podemos proceder a derivar el hamiltoniano por la transformación de Legendre, el momento conjugado se define como
\begin{equation}
    p_\alpha=\frac{\partial L}{\partial \dot{x}^\alpha}=\frac{\partial }{\partial \dot{x}^\alpha}\left( \frac{1}{2} M g_{\mu \nu} \dot{x}^\mu \dot{x}^\nu\right)= M g_{\alpha \nu} \dot{x}^\nu
\end{equation}
multiplicando ambos lados por $g^{\alpha \beta}$ se obtiene
\begin{equation}
    g^{\alpha \beta} p_\alpha = g^{\alpha \beta} M g_{\alpha \nu} \dot{x}^\nu = M \delta^\beta_\nu \dot{x}^\nu = M \dot{x}^\beta \rightarrow  \dot{x}^\beta= \frac{p^{\beta}}{M}
\end{equation}
Y se escribe el hamiltoniano como

\begin{equation}
    \begin{aligned}
        H(x, p) & =p_\mu \dot{x}^\mu-L=  \frac{p_\mu p^{\mu}}{M} -\frac{1}{2} M g_{\mu \nu} \frac{p^{\mu}}{M} \frac{p^{\nu}}{M} \\
                & = \frac{1}{2M}  p_\mu p^{\mu}                                                                                 \\
                & = \frac{1}{2M} g^{\mu \nu} p_\mu p_\nu
    \end{aligned}
\end{equation}

La ecuación de Hamilton-Jacobi para la función principal $S\left(x^\mu, \lambda\right)$ es

\begin{equation}
    \frac{\partial S}{\partial \lambda}+H(x, \partial S / \partial x)=0
    \label{eq:HamiltonJacobi}
\end{equation}

donde $\lambda$ es un parámetro afín a lo largo de la trayectoria.Con las transformaciones canónicas usuales
\begin{equation}
    \frac{\partial S}{\partial x^\mu} = p_\mu \quad ; \quad \frac{\partial S}{\partial \lambda} = -H,
\end{equation}
la ecuación de Hamilton-Jacobi en este caso se convierte en
\begin{equation}
    \frac{\partial S}{\partial \lambda}+\frac{1}{2M} g^{\mu \nu} \frac{\partial S}{\partial x^\mu}  \frac{\partial S}{\partial x^\nu} =0.
\end{equation}
Aquí es útil calcular ahora la cantidad contravariante $g^{\mu \nu} p_\mu p_\nu$
\begin{equation}
    g^{\mu \nu} p_\mu p_\nu=M^2 g^{\mu \nu} g_{\mu \alpha} g_{\nu \beta} \dot{x}^\alpha \dot{x}^\beta=M^2 g_{\alpha \beta} \dot{x}^\alpha \dot{x}^\beta
\end{equation}
Recuérdese que geodésicas timelike normalizadas con tiempo propio $g_{\alpha \beta} \dot{x}^\alpha \dot{x}^\beta=-c^2 \rightarrow g^{\mu \nu} p_\mu p_\nu=-M^2 c^2$, y por tanto
\begin{equation}
    \frac{\partial S}{\partial \lambda}=\frac{1}{2} M c^2,
\end{equation}
podemos buscar una solución separada del tipo
\begin{equation}
    S(x, \lambda)=W(x)+\frac{1}{2} Mc^2 \lambda
\end{equation}
(donde la parte lineal en $\lambda$ refleja que el hamiltoniano es constante a lo largo de la evolución afín).
Sustituyendo el Hamiltoniano en (\ref{eq:HamiltonJacobi}) se obtiene:
\begin{equation}
    \frac{1}{2} Mc^2+\frac{1}{2 M} g^{\mu \nu} \partial_\mu S \partial_\nu S=0 \quad \Longrightarrow \quad g^{\mu \nu} \partial_\mu S \partial_\nu S=-M^2 c^2
    \label{eq:geodesicHamiltonJacobi}
\end{equation}
esta es la ecuación de Hamilton-Jacobi para geodésicas.


\section{De klein Gordon a Hamilton Jacobi}

Comenzamos con los dos elementos que usted ha planteado:
1. La Ecuación de Klein-Gordon (K-G) para un campo escalar $\phi$ sin masa en espaciotiempo curvo: $\square \phi=g^{\mu \nu} \nabla_\mu \nabla_\nu \phi=0$ (Donde $\nabla_\mu$ es la derivada covariante).
2. El "Ansatz" WKB (Eikonal): $\phi(x)=C(x) \exp \left(\frac{i}{\hbar} S(x)\right)$ (Donde $S(x)$ varia rápidamente y $C(x)$ varia lentamente).

Nuestro objetivo es sustituir (2) en (1) y analizar el resultado en el limite $\hbar \rightarrow 0$.

Paso 1: Calcular la primera derivada covariante $\left(\nabla_\nu \phi\right)$
Aplicamos $\nabla_\nu$ al ansatz. Usando la regla del producto (regla de Leibniz), que se aplica a las derivadas covariantes: $\nabla_\nu \phi=\nabla_\nu\left(C e^{i S / \hbar}\right)=\left(\nabla_\nu C\right) e^{i S / \hbar}+C\left(\nabla_\nu e^{i S / \hbar}\right)$

Ahora, resolvemos cada parte:
- Como $C$ es un escalar, $\nabla_\nu C=\partial_\nu C$.
- Usando la regla de la cadena (ya que $S$ es un escalar, $\nabla_\nu S=\partial_\nu S$ ): $\nabla_\nu e^{i S / \hbar}= \left(\frac{d}{d S} e^{i S / \hbar}\right) \nabla_\nu S=\left(\frac{i}{\hbar} e^{i S / \hbar}\right) \partial_\nu S$

Sustituimos estos resultados de nuevo: $\nabla_\nu \phi=\left(\partial_\nu C\right) e^{i S / \hbar}+C\left(\frac{i}{\hbar} e^{i S / \hbar}\right) \partial_\nu S$
Agrupando, la primera derivada es: $\nabla_\nu \phi=\left(\partial_\nu C+\frac{i}{\hbar} C\left(\partial_\nu S\right)\right) e^{i S / \hbar}$
Paso 2: Calcular la segunda derivada covariante ( $\square \phi=g^{\mu \nu} \nabla_\mu \nabla_\nu \phi$ )
Ahora aplicamos el operador $g^{\mu \nu} \nabla_\mu$ al resultado del Paso 1. $\square \phi= g^{\mu \nu} \nabla_\mu\left[\left(\partial_\nu C+\frac{i}{\hbar} C\left(\partial_\nu S\right)\right) e^{i S / \hbar}\right]$

Nuevamente, usamos la regla del producto. El operador $\nabla_\mu$ actúa sobre el término entre corchetes $[\ldots]$ y sobre el término exponencial $e^{i S / \hbar}$ :

$$
\square \phi=g^{\mu \nu} \underbrace{\left[\nabla_\mu\left(\partial_\nu C+\frac{i}{\hbar} C\left(\partial_\nu S\right)\right)\right] e^{i S / \hbar}}_{\text {Término 1 }}+g^{\mu \nu} \underbrace{\left[\left(\partial_\nu C+\frac{i}{\hbar} C\left(\partial_\nu S\right)\right)\left(\nabla_\mu e^{i S / \hbar}\right)\right]}_{\text {Término 2 }}
$$


Paso 3: Analizar cada término y agrupar por potencias de $\hbar$
Análisis del Término 2: Usamos $\nabla_\mu e^{i S / \hbar}=\left(\frac{i}{\hbar} e^{i S / \hbar}\right) \partial_\mu S$ (del Paso 1). Término $2= g^{\mu \nu}\left(\partial_\nu C+\frac{i}{\hbar} C\left(\partial_\nu S\right)\right)\left(\frac{i}{\hbar} \partial_\mu S\right) e^{i S / \hbar}$

Distribuimos el producto: Término $2=\left[g^{\mu \nu}\left(\partial_\nu C\right)\left(\frac{i}{\hbar} \partial_\mu S\right)+g^{\mu \nu}\left(\frac{i}{\hbar} C\left(\partial_\nu S\right)\right)\left(\frac{i}{\hbar} \partial_\mu S\right)\right] e^{i S / \hbar}$
Simplificamos (notando que $(i / \hbar)^2=-1 / \hbar^2$ y que $g^{\mu \nu}\left(\partial_\nu C\right)\left(\partial_\mu S\right)=g^{\mu \nu}\left(\partial_\mu C\right)\left(\partial_\nu S\right)$ por la simetría de $g^{\mu \nu}$ ): Término $2=\left[\frac{i}{\hbar} g^{\mu \nu}\left(\partial_\mu C\right)\left(\partial_\nu S\right)-\frac{1}{\hbar^2} C g^{\mu \nu}\left(\partial_\mu S\right)\left(\partial_\nu S\right)\right] e^{i S / \hbar}$

Análisis del Término 1: Término $1=g^{\mu \nu}\left[\nabla_\mu\left(\partial_\nu C\right)+\nabla_\mu\left(\frac{i}{\hbar} C\left(\partial_\nu S\right)\right)\right] e^{i S / \hbar}$
Expandimos la segunda parte del corchete usando la regla del producto: Término $1= g^{\mu \nu}\left[\nabla_\mu \partial_\nu C+\frac{i}{\hbar}\left(\nabla_\mu C\right)\left(\partial_\nu S\right)+\frac{i}{\hbar} C\left(\nabla_\mu \partial_\nu S\right)\right] e^{i S / \hbar}$

Ahora, usamos las definiciones $g^{\mu \nu} \nabla_\mu \partial_\nu C=\square C$ (D'Alembertian de $C$ ) y $g^{\mu \nu} \nabla_\mu \partial_\nu S=\square S$. Y recordamos $\nabla_\mu C=\partial_\mu C$. Término $1=\left[\square C+\frac{i}{\hbar} g^{\mu \nu}\left(\partial_\mu C\right)\left(\partial_\nu S\right)+\frac{i}{\hbar} C(\square S)\right] e^{i S / \hbar}$

Paso 4: Sumar los términos y tomar el limite $\hbar \rightarrow 0$
Ahora sumamos Término $1+$ Término 2 y lo igualamos a cero (según la ecuación de $\mathrm{K}-\mathrm{G}$ ):

$$
\square \phi=\text { (Término } 1+\text { Término } 2 \text { ) }=0
$$


Dividimos por el factor común $e^{i S / \hbar}$ (que no es cero): $0=$

$$
\left[\square C+\frac{i}{\hbar} g^{\mu \nu}\left(\partial_\mu C\right)\left(\partial_\nu S\right)+\frac{i}{\hbar} C(\square S)\right]+\left[\frac{i}{\hbar} g^{\mu \nu}\left(\partial_\mu C\right)\left(\partial_\nu S\right)-\frac{1}{\hbar^2} C g^{\mu \nu}\left(\partial_\mu S\right)\left(\partial_\nu S\right)\right]
$$


Finalmente, agrupamos los términos por sus potencias de $\hbar$ :

$$
\underbrace{-\frac{1}{\hbar^2} C\left(g^{\mu \nu}\left(\partial_\mu S\right)\left(\partial_\nu S\right)\right)}_{\mathcal{O}\left(\hbar^{-2}\right)}+\underbrace{\frac{i}{\hbar}\left(2 g^{\mu \nu}\left(\partial_\mu C\right)\left(\partial_\nu S\right)+C(\square S)\right)}_{\mathcal{O}\left(\hbar^{-1}\right)}+\underbrace{\square C}_{\mathcal{O}\left(\hbar^0\right)}=0
$$


En el limite semiclásico ( $\hbar \rightarrow 0$ ), $\hbar$ es un parámetro pequeño. Para que esta ecuación sea válida, los coeficientes de cada potencia de $\hbar$ deben anularse independientemente.

El término dominante, de orden $\mathcal{O}\left(\hbar^{-2}\right)$, debe ser cero: $-\frac{1}{\hbar^2} C\left(g^{\mu \nu}\left(\partial_\mu S\right)\left(\partial_\nu S\right)\right)=0$
Asumiendo que la amplitud $C(x)$ no es trivial ( $C \neq 0$ ), la única forma de satisfacer la ecuación es si el término en el paréntesis es cero.

$$
g^{\mu \nu}\left(\partial_\mu S\right)\left(\partial_\nu S\right)=0
$$


Quod Erat Demonstrandum.
Hemos demostrado que, en el límite semiclásico, la ecuación de onda cuántica de Klein-Gordon se reduce a la ecuación de Hamilton-Jacobi para una partícula relativista sin masa.
(Como nota adicional, el siguiente término, de orden $\mathcal{O}\left(\hbar^{-1}\right)$, debe anularse también, $2 g^{\mu \nu}\left(\partial_\mu C\right)\left(\partial_\nu S\right)+C(\square S)=0$. Esta es la ecuación de transporte, que describe cómo la amplitud $C$ evoluciona a lo largo de las geodésicas nulas definidas por $S$ ).